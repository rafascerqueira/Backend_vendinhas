{"version":3,"sources":["../../src/config/passport.js"],"names":["require","config","secret","process","env","AUTH_SECRET","opts","secretOrKey","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","strategy","Strategy","payload","done","User","findById","id","err","user","passport","use","authenticate","session"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACAA,OAAO,CAAC,QAAD,CAAP,CAAkBC,MAAlB;;AACA,MAAMC,MAAM,GAAGC,OAAO,CAACC,GAAR,CAAYC,WAA3B;;AAEe,oBAAW;AACxB,QAAMC,IAAI,GAAG;AACXC,IAAAA,WAAW,EAAEL,MADF;AAEXM,IAAAA,cAAc,EAAEC,wBAAWC,2BAAX;AAFL,GAAb;AAIA,QAAMC,QAAQ,GAAG,IAAIC,qBAAJ,CAAaN,IAAb,EAAmB,CAACO,OAAD,EAAUC,IAAV,KAAmB;AACrDC,kBAAKC,QAAL,CAAcH,OAAO,CAACI,EAAtB,EAA0B,CAACC,GAAD,EAAMC,IAAN,KAAe;AACvC,UAAID,GAAJ,EAAS;AACP,eAAOJ,IAAI,CAACI,GAAD,EAAM,KAAN,CAAX;AACD;;AACD,UAAIC,IAAJ,EAAU;AACR,eAAOL,IAAI,CAAC,IAAD,EAAOK,IAAP,CAAX;AACD,OAFD,MAEO;AACL,eAAOL,IAAI,CAAC,IAAD,EAAO,KAAP,CAAX;AACD;AACF,KATD;AAUD,GAXgB,CAAjB;;AAaAM,oBAASC,GAAT,CAAaV,QAAb;;AAEA,SAAO;AACLW,IAAAA,YAAY,EAAE,MAAMF,kBAASE,YAAT,CAAsB,KAAtB,EAA6B;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAA7B;AADf,GAAP;AAGD","sourcesContent":["import passport from \"passport\";\nimport { Strategy, ExtractJwt } from \"passport-jwt\";\nimport User from \"../models/User\";\nrequire(\"dotenv\").config();\nconst secret = process.env.AUTH_SECRET;\n\nexport default function() {\n  const opts = {\n    secretOrKey: secret,\n    jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken()\n  };\n  const strategy = new Strategy(opts, (payload, done) => {\n    User.findById(payload.id, (err, user) => {\n      if (err) {\n        return done(err, false);\n      }\n      if (user) {\n        return done(null, user);\n      } else {\n        return done(null, false);\n      }\n    });\n  });\n\n  passport.use(strategy);\n\n  return {\n    authenticate: () => passport.authenticate(\"jwt\", { session: false })\n  };\n}\n"],"file":"passport.js"}
{"version":3,"sources":["../../src/controllers/billingHandler.js"],"names":["Invoice","Order","Customer","require","module","exports","index","req","res","bill","findAll","include","model","json","error","showSelectedBills","invoiced","body","bills","where","status","store","id","hasOrder","length","invoice","create","order_id","update","paid"],"mappings":";;AAAA,MAAM;AAAEA,EAAAA,OAAF;AAAWC,EAAAA,KAAX;AAAkBC,EAAAA;AAAlB,IAA+BC,OAAO,CAAC,6BAAD,CAA5C;;AAEAC,MAAM,CAACC,OAAP,GAAiB;AACf,QAAMC,KAAN,CAAYC,GAAZ,EAAiBC,GAAjB,EAAsB;AACpB,QAAI;AACF,YAAMC,IAAI,GAAG,MAAMT,OAAO,CAACU,OAAR,CAAgB;AACjCC,QAAAA,OAAO,EAAE,CAAC;AAAEC,UAAAA,KAAK,EAAEX,KAAT;AAAgBU,UAAAA,OAAO,EAAE,CAAC;AAAEC,YAAAA,KAAK,EAAEV;AAAT,WAAD;AAAzB,SAAD;AADwB,OAAhB,CAAnB;AAIA,aAAOM,GAAG,CAACK,IAAJ,CAASJ,IAAT,CAAP;AACD,KAND,CAME,OAAOK,KAAP,EAAc;AACd,aAAON,GAAG,CAACK,IAAJ,CAASC,KAAT,CAAP;AACD;AACF,GAXc;;AAaf,QAAMC,iBAAN,CAAwBR,GAAxB,EAA6BC,GAA7B,EAAkC;AAChC,UAAM;AAAEQ,MAAAA;AAAF,QAAeT,GAAG,CAACU,IAAzB;;AACA,QAAI;AACF,YAAMC,KAAK,GAAG,MAAMlB,OAAO,CAACU,OAAR,CAAgB;AAClCC,QAAAA,OAAO,EAAE,CAAC;AAAEC,UAAAA,KAAK,EAAEX,KAAT;AAAgBU,UAAAA,OAAO,EAAE,CAAC;AAAEC,YAAAA,KAAK,EAAEV;AAAT,WAAD;AAAzB,SAAD,CADyB;AAElCiB,QAAAA,KAAK,EAAE;AAAEH,UAAAA;AAAF;AAF2B,OAAhB,CAApB;AAKA,aAAOR,GAAG,CAACK,IAAJ,CAASK,KAAT,CAAP;AACD,KAPD,CAOE,OAAOJ,KAAP,EAAc;AACd,aAAON,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBP,IAAhB,CAAqBC,KAArB,CAAP;AACD;AACF,GAzBc;;AA2Bf,QAAMO,KAAN,CAAYd,GAAZ,EAAiBC,GAAjB,EAAsB;AACpB,UAAM;AAAEc,MAAAA;AAAF,QAASf,GAAG,CAACU,IAAnB;;AACA,QAAI;AACF,YAAMM,QAAQ,GAAG,MAAMtB,KAAK,CAACS,OAAN,CAAc;AAAES,QAAAA,KAAK,EAAE;AAAEG,UAAAA;AAAF;AAAT,OAAd,CAAvB;AACA,UAAIC,QAAQ,CAACC,MAAT,GAAkB,CAAtB,EAAyB,MAAM,2BAAN;AAEzB,YAAMC,OAAO,GAAG,MAAMzB,OAAO,CAAC0B,MAAR,CAAe;AAAEC,QAAAA,QAAQ,EAAEL,EAAZ;AAAgBN,QAAAA,QAAQ,EAAE;AAA1B,OAAf,CAAtB;AAEA,aAAOR,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBP,IAAhB,CAAqBY,OAArB,CAAP;AACD,KAPD,CAOE,OAAOX,KAAP,EAAc;AACd,aAAON,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBP,IAAhB,CAAqBC,KAArB,CAAP;AACD;AACF,GAvCc;;AAyCf,QAAMc,MAAN,CAAarB,GAAb,EAAkBC,GAAlB,EAAuB;AACrB,UAAM;AAAEc,MAAAA,EAAF;AAAMN,MAAAA;AAAN,QAAmBT,GAAG,CAACU,IAA7B;;AACA,QAAI;AACF,YAAMY,IAAI,GAAG,MAAM7B,OAAO,CAAC4B,MAAR,CAAe;AAAEZ,QAAAA;AAAF,OAAf,EAA6B;AAAEG,QAAAA,KAAK,EAAE;AAAEG,UAAAA;AAAF;AAAT,OAA7B,CAAnB;AACA,aAAOd,GAAG,CAACK,IAAJ,CAASgB,IAAT,CAAP;AACD,KAHD,CAGE,OAAOf,KAAP,EAAc;AACd,aAAON,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBP,IAAhB,CAAqBC,KAArB,CAAP;AACD;AACF;;AAjDc,CAAjB","sourcesContent":["const { Invoice, Order, Customer } = require(\"../database/postgres/models\");\n\nmodule.exports = {\n  async index(req, res) {\n    try {\n      const bill = await Invoice.findAll({\n        include: [{ model: Order, include: [{ model: Customer }] }],\n      });\n\n      return res.json(bill);\n    } catch (error) {\n      return res.json(error);\n    }\n  },\n\n  async showSelectedBills(req, res) {\n    const { invoiced } = req.body;\n    try {\n      const bills = await Invoice.findAll({\n        include: [{ model: Order, include: [{ model: Customer }] }],\n        where: { invoiced },\n      });\n\n      return res.json(bills);\n    } catch (error) {\n      return res.status(404).json(error);\n    }\n  },\n\n  async store(req, res) {\n    const { id } = req.body;\n    try {\n      const hasOrder = await Order.findAll({ where: { id } });\n      if (hasOrder.length < 1) throw \"Error, cannot find Order.\";\n\n      const invoice = await Invoice.create({ order_id: id, invoiced: false });\n\n      return res.status(201).json(invoice);\n    } catch (error) {\n      return res.status(404).json(error);\n    }\n  },\n\n  async update(req, res) {\n    const { id, invoiced } = req.body;\n    try {\n      const paid = await Invoice.update({ invoiced }, { where: { id } });\n      return res.json(paid);\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n  },\n};\n"],"file":"billingHandler.js"}